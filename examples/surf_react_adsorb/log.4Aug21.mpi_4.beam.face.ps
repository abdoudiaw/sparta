SPARTA (26 Feb 2021)
# beam of particles striking the surface at an inclined angle
# free molecular flow (no collisions)

seed	    	    123456
dimension   	    3
global              gridcut 0.0 comm/sort yes

boundary	    	oo oo so


create_box          -11 11 -11 11 0 10
Created orthogonal box = (-11 -11 0) to (11 11 10)
create_grid 	    2 2 2
WARNING: Could not acquire nearby ghost cells b/c grid partition is not clumped (../grid.cpp:410)
Created 8 child grid cells
  CPU time = 0.00159452 secs
  create/ghost percent = 94.2926 5.70743
balance_grid        rcb cell
Balance grid migrated 4 cells
  CPU time = 0.00082785 secs
  reassign/sort/migrate/ghost percent = 71.9142 0.337501 12.7985 14.9498

global		    	nrho 1e10 fnum 1e6

species		    	air.species O CO CO2 O2 C
mixture		    	air O O2 vstream 0 1000 -1000

mixture             air O   frac 1.0
mixture             air CO  frac 0.0
mixture             air CO2 frac 0.0
mixture             air C   frac 0.0
mixture 			air O2 frac 0.0


surf_collide        1 cll 300.0 0.5 0.5 0.5 0.5

bound_modify 		zlo collide 1

##################################### SURF REACT ADSORB ######################################
##################################### FACE/BOUNDARY OPTION ###################################

#surf_react        	adsorb_test_ps1 adsorb ps sample-PS_1.surf nsync 1 face 1000 6.022e18 O CO
#bound_modify        zlo react adsorb_test_ps1


surf_react        	adsorb_test_ps2 adsorb ps sample-PS_2.surf nsync 1 face 1000 6.022e18 O CO
bound_modify        zlo react adsorb_test_ps2

########################## BEAM ############################################################
# Beam at multiple points so that different processors handle the surface collisions

region              circle1 cylinder z  0 -10 1 -INF INF

fix                 in1 emit/face/file air zhi data.beam beam_area_1 nevery 100 region circle1

################################################################################################

#dump                2 image all 10 image.*.ppm type type pdiam 0.2 surf proc 0.01 size 512 512 zoom 1.75 gline no 0.005
#dump_modify	     2 pad 4

timestep            0.0001

stats		    	10
stats_style	    	step cpu np nattempt ncoll nscoll nscheck
run 		    	1000
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 0 0 0
  grid      (ave,min,max) = 1.51379 1.51379 1.51379
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 1.51379 1.51379 1.51379
Step CPU Np Natt Ncoll Nscoll Nscheck 
       0            0        0        0        0        0        0 
      10   0.00040942        0        0        0        0        0 
      20    0.0007256        0        0        0        0        0 
      30  0.001038358        0        0        0        0        0 
      40  0.001364735        0        0        0        0        0 
      50  0.001701797        0        0        0        0        0 
      60  0.002014485        0        0        0        0        0 
      70   0.00232396        0        0        0        0        0 
      80  0.002648102        0        0        0        0        0 
      90  0.002975387        0        0        0        0        0 
     100  0.006656887     3122        0        0        0        0 
     110   0.00753279     3123        0        0        0        0 
     120  0.009486372     3124        0        0        0        0 
     130  0.010292501     3124        0        0        0        0 
     140   0.01107195     3124        0        0        0        0 
     150  0.011853704     3124        0        0        0        0 
     160  0.012602003     3124        0        0        0        0 
     170  0.013326696     3124        0        0        0        0 
     180  0.014065356     3124        0        0        0        0 
     190  0.016072298     3124        0        0        0        0 
     200  0.019020307     6261        0        0        0        0 
     210  0.020472485     6261        0        0        0        0 
     220    0.0214498     6261        0        0        0        0 
     230  0.022357411     6261        0        0        0        0 
     240  0.023239809     6260        0        0        0        0 
     250  0.024129191     6260        0        0        0        0 
     260  0.025021158     6257        0        0        0        0 
     270   0.02588812     6231        0        0        0        0 
     280  0.026754524     6107        0        0        0        0 
     290   0.02756666     5831        0        0        0        0 
     300  0.030137096     8580        0        0        0        0 
     310  0.031426959     8137        0        0        0        0 
     320  0.032378711     7719        0        0        0        0 
     330  0.033287161     7374        0        0        0        0 
     340  0.034092033     7088        0        0        0        0 
     350  0.034927775     6892        0        0        0        0 
     360  0.035702056     6738        0        0        0        0 
     370  0.036495544     6601        0        0        0        0 
     380   0.03726319     6398        0        0        0        0 
     390  0.038030765     6079        0        0        0        0 
     400  0.040433858     8809        0        0        0        0 
     410  0.041678462     8341        0        0        0        0 
     420  0.042563724     7868        0        0        0        0 
     430  0.043456877     7489        0        0        0        0 
     440  0.044254206     7210        0        0        0        0 
     450  0.045072419     6984        0        0        0        0 
     460  0.045875614     6830        0        0        0        0 
     470  0.046664283     6690        0        0        0        0 
     480  0.047450647     6475        0        0        0        0 
     490  0.048191542     6114        0        0        0        0 
     500  0.050456904     8774        0        0        0        0 
     510  0.051564686     8291        0        0        0        0 
     520  0.052430601     7841        0        0        0        0 
     530  0.053210958     7463        0        0        0        0 
     540  0.054019392     7183        0        0        0        0 
     550  0.054759659     6940        0        0        0        0 
     560  0.055486586     6786        0        0        0        0 
     570  0.056209183     6612        0        0        0        0 
     580   0.05694093     6399        0        0        0        0 
     590  0.057659964     6048        0        0        0        0 
     600   0.05980317     8736        0        0        0        0 
     610   0.06088518     8258        0        0        0        0 
     620  0.061714427     7821        0        0        0        0 
     630  0.062489197     7460        0        0        0        0 
     640  0.063221432     7172        0        0        0        0 
     650  0.064029517     6935        0        0        0        0 
     660  0.064746177     6759        0        0        0        0 
     670  0.065468355     6613        0        0        0        0 
     680  0.066154843     6416        0        0        0        0 
     690  0.066844404     6062        0        0        0        0 
     700  0.068881868     8757        0        0        0        0 
     710  0.070034629     8264        0        0        0        0 
     720  0.070864016     7823        0        0        0        0 
     730  0.071620486     7434        0        0        0        0 
     740  0.072324924     7145        0        0        0        0 
     750  0.073029013     6919        0        0        0        0 
     760  0.073700903     6744        0        0        0        0 
     770  0.074393607     6583        0        0        0        0 
     780  0.075100071     6392        0        0        0        0 
     790  0.075800527     6059        0        0        0        0 
     800  0.077776319     8754        0        0        0        0 
     810  0.078830322     8293        0        0        0        0 
     820  0.079704897     7852        0        0        0        0 
     830  0.080510607     7475        0        0        0        0 
     840  0.081304514     7192        0        0        0        0 
     850  0.082044642     6961        0        0        0        0 
     860  0.082733574     6788        0        0        0        0 
     870  0.083398341     6658        0        0        0        0 
     880  0.084050257     6438        0        0        0        0 
     890  0.084681569     6099        0        0        0        0 
     900  0.086630541     8807        0        0        0        0 
     910  0.087648784     8324        0        0        0        0 
     920  0.088464901     7885        0        0        0        0 
     930  0.089214108     7529        0        0        0        0 
     940  0.089924692     7244        0        0        0        0 
     950  0.090642609     6993        0        0        0        0 
     960  0.091418147     6828        0        0        0        0 
     970  0.092068456     6671        0        0        0        0 
     980  0.092693203     6486        0        0        0        0 
     990  0.093310965     6149        0        0        0        0 
    1000  0.095146023     8799        0        0        0        0 
Loop time of 0.0951679 on 4 procs for 1000 steps with 8799 particles

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Move    | 0.029681   | 0.032722   | 0.039505   |   2.2 | 34.38
Coll    | 0          | 0          | 0          |   0.0 |  0.00
Sort    | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.018733   | 0.019402   | 0.019802   |   0.3 | 20.39
Modify  | 0.0017901  | 0.0066898  | 0.013088   |   6.1 |  7.03
Output  | 0.0022814  | 0.0025838  | 0.0034286  |   1.0 |  2.72
Other   |            | 0.03377    |            |       | 35.49

Particle moves    = 5928048 (5.93M)
Cells touched     = 6017738 (6.02M)
Particle comms    = 38121 (38.1K)
Boundary collides = 28329 (28.3K)
Boundary exits    = 22691 (22.7K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Surf reactions    = 0 (0K)
Collide attempts  = 0 (0K)
Collide occurs    = 0 (0K)
Reactions         = 0 (0K)
Particles stuck   = 0
Axisymm bad moves = 0

Particle-moves/CPUsec/proc: 1.55726e+07
Particle-moves/step: 5928.05
Cell-touches/particle/step: 1.01513
Particle comm iterations/step: 1.899
Particle fraction communicated: 0.00643062
Particle fraction colliding with boundary: 0.00477881
Particle fraction exiting boundary: 0.00382774
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Surf-reactions/particle/step: 0
Collision-attempts/particle/step: 0
Collisions/particle/step: 0
Reactions/particle/step: 0

Surface reaction tallies:
  id adsorb_test_ps2 style adsorb #-of-reactions 5
    reaction all: 10
    reaction C(b) --> C(g): 10

Particles: 2199.75 ave 2334 max 2057 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Cells:      2 ave 2 max 2 min
Histogram: 4 0 0 0 0 0 0 0 0 0
GhostCell: 6 ave 6 max 6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
EmptyCell: 6 ave 6 max 6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
