SPARTA (7 Jul 2014)
# advect particles on uniform 3d Cartesian grid
# particles reflect off global box boundaries

variable            x index 10
variable            y index 10
variable            z index 10

variable            lx equal $x*1.0e-5
variable            lx equal 20*1.0e-5
variable            ly equal $y*1.0e-5
variable            ly equal 20*1.0e-5
variable            lz equal $z*1.0e-5
variable            lz equal 25*1.0e-5

variable            n equal 10*$x*$y*$z
variable            n equal 10*20*$y*$z
variable            n equal 10*20*20*$z
variable            n equal 10*20*20*25

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5

boundary	    rr rr rr

create_box  	    0 ${lx} 0 ${ly} 0 ${lz}
create_box  	    0 0.0002 0 ${ly} 0 ${lz}
create_box  	    0 0.0002 0 0.0002 0 ${lz}
create_box  	    0 0.0002 0 0.0002 0 0.00025
Created orthogonal box = (0 0 0) to (0.0002 0.0002 0.00025)
create_grid 	    $x $y $z
create_grid 	    20 $y $z
create_grid 	    20 20 $z
create_grid 	    20 20 25
Created 10000 child grid cells
  parent cells = 1
  CPU time = 0.00202703 secs
  create/ghost percent = 86.6737 13.3263

balance_grid        rcb part
Balance grid migrated 8560 cells
  CPU time = 0.00487804 secs
  reassign/sort/migrate/ghost percent = 14.0029 0.224829 14.1447 71.6276

species		    ../data/ar.species Ar
mixture		    air Ar vstream 0.0 0.0 0.0 temp 273.15

global              nrho 7.07043E22
global              fnum 7.07043E6

collide		    vss air ../data/ar.vss

create_particles    air n $n
create_particles    air n 100000
Created 100000 particles
  CPU time = 0.00300002 secs

stats		    10
compute             temp temp
stats_style	    step cpu np nattempt ncoll c_temp

# first equilibrate with large timestep to unsort particles
# then benchmark with normal timestep

timestep 	    7.00E-8
run                 30
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 2.05994 2.05994 2.05994
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 3.89107 3.89107 3.89107
Step CPU Np Natt Ncoll temp 
       0            0   100000        0        0    273.04554 
      10  0.047905207   100000    96666    70787    273.04554 
      20  0.095625162   100000    98913    70744    273.04554 
      30   0.14384508   100000   100379    70792    273.04554 
Loop time of 0.143873 on 8 procs for 30 steps with 100000 particles

Particle moves    = 3000000 (3M)
Cells touched     = 14408603 (14.4M)
Particle comms    = 544259 (0.544M)
Boundary collides = 556940 (0.557M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 2910344 (2.91M)
Collide occurs    = 2114149 (2.11M)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 2.60646e+06
Particle-moves/step: 100000
Cell-touches/particle/step: 4.80287
Particle comm iterations/step: 3
Particle fraction communicated: 0.18142
Particle fraction colliding with boundary: 0.185647
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.970115
Collisions/particle/step: 0.704716

Move  time (%) = 0.084252 (58.5599)
Coll  time (%) = 0.0552501 (38.4019)
Sort  time (%) = 0.00353217 (2.45506)
Comm  time (%) = 0.000292987 (0.203642)
Outpt time (%) = 0.000521094 (0.362189)
Other time (%) = 2.48849e-05 (0.0172964)

Particles: 12500 ave 12902 max 12092 min
Histogram: 1 0 0 1 3 0 1 1 0 1
Cells:      1250 ave 1250 max 1250 min
Histogram: 8 0 0 0 0 0 0 0 0 0
GhostCell: 838 ave 910 max 766 min
Histogram: 4 0 0 0 0 0 0 0 0 4
EmptyCell: 394 ave 466 max 322 min
Histogram: 4 0 0 0 0 0 0 0 0 4
timestep 	    7.00E-9
run 		    100
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 2.05994 2.05994 2.05994
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 3.89107 3.89107 3.89107
Step CPU Np Natt Ncoll temp 
      30            0   100000   100379    70792    273.04554 
      40 0.0076911449   100000     9008     7030    273.04554 
      50  0.015480995   100000     9176     7085    273.04554 
      60  0.023215055   100000     9305     7032    273.04554 
      70   0.03094697   100000     9430     7137    273.04554 
      80  0.038681984   100000     9489     7068    273.04554 
      90  0.046384096   100000     9527     6983    273.04554 
     100  0.054162025   100000     9592     7080    273.04554 
     110  0.061885118   100000     9675     7102    273.04554 
     120  0.069689989   100000     9689     7059    273.04554 
     130   0.07745409   100000     9702     6986    273.04554 
Loop time of 0.077477 on 8 procs for 100 steps with 100000 particles

Particle moves    = 10000000 (10M)
Cells touched     = 13810700 (13.8M)
Particle comms    = 234097 (0.234M)
Boundary collides = 185982 (0.186M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 937308 (0.937M)
Collide occurs    = 702188 (0.702M)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 1.61338e+07
Particle-moves/step: 100000
Cell-touches/particle/step: 1.38107
Particle comm iterations/step: 1
Particle fraction communicated: 0.0234097
Particle fraction colliding with boundary: 0.0185982
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.0937308
Collisions/particle/step: 0.0702188

Move  time (%) = 0.0372622 (48.0946)
Coll  time (%) = 0.0244604 (31.5712)
Sort  time (%) = 0.0100059 (12.9147)
Comm  time (%) = 0.00468254 (6.04378)
Outpt time (%) = 0.00102267 (1.31996)
Other time (%) = 4.32432e-05 (0.0558142)

Particles: 12500 ave 12677 max 12387 min
Histogram: 3 0 1 1 0 0 1 1 0 1
Cells:      1250 ave 1250 max 1250 min
Histogram: 8 0 0 0 0 0 0 0 0 0
GhostCell: 838 ave 910 max 766 min
Histogram: 4 0 0 0 0 0 0 0 0 4
EmptyCell: 394 ave 466 max 322 min
Histogram: 4 0 0 0 0 0 0 0 0 4

