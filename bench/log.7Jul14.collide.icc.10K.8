SPARTA (7 Jul 2014)
# advect particles on uniform 3d Cartesian grid
# particles reflect off global box boundaries

variable            x index 10
variable            y index 10
variable            z index 10

variable            lx equal $x*1.0e-5
variable            lx equal 10*1.0e-5
variable            ly equal $y*1.0e-5
variable            ly equal 10*1.0e-5
variable            lz equal $z*1.0e-5
variable            lz equal 10*1.0e-5

variable            n equal 10*$x*$y*$z
variable            n equal 10*10*$y*$z
variable            n equal 10*10*10*$z
variable            n equal 10*10*10*10

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5

boundary	    rr rr rr

create_box  	    0 ${lx} 0 ${ly} 0 ${lz}
create_box  	    0 0.0001 0 ${ly} 0 ${lz}
create_box  	    0 0.0001 0 0.0001 0 ${lz}
create_box  	    0 0.0001 0 0.0001 0 0.0001
Created orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
create_grid 	    $x $y $z
create_grid 	    10 $y $z
create_grid 	    10 10 $z
create_grid 	    10 10 10
Created 1000 child grid cells
  parent cells = 1
  CPU time = 0.00331688 secs
  create/ghost percent = 89.5702 10.4298

balance_grid        rcb part
Balance grid migrated 872 cells
  CPU time = 0.00106096 secs
  reassign/sort/migrate/ghost percent = 30.3596 0.382022 11.4831 57.7753

species		    ../data/ar.species Ar
mixture		    air Ar vstream 0.0 0.0 0.0 temp 273.15

global              nrho 7.07043E22
global              fnum 7.07043E6

collide		    vss air ../data/ar.vss

create_particles    air n $n
create_particles    air n 10000
Created 10000 particles
  CPU time = 0.000882864 secs

stats		    10
compute             temp temp
stats_style	    step cpu np nattempt ncoll c_temp

# first equilibrate with large timestep to unsort particles
# then benchmark with normal timestep

timestep 	    7.00E-8
run                 30
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 1.02997 1.02997 1.02997
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 2.8611 2.8611 2.8611
Step CPU Np Natt Ncoll temp 
       0            0    10000        0        0    269.39603 
      10 0.0054490566    10000     9610     7012    269.39603 
      20  0.010893106    10000     9877     7104    269.39603 
      30  0.016111135    10000    10065     7068    269.39603 
Loop time of 0.0161304 on 8 procs for 30 steps with 10000 particles

Particle moves    = 300000 (0.3M)
Cells touched     = 1364642 (1.36M)
Particle comms    = 104611 (0.105M)
Boundary collides = 115604 (0.116M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 290798 (0.291M)
Collide occurs    = 210982 (0.211M)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 2.3248e+06
Particle-moves/step: 10000
Cell-touches/particle/step: 4.54881
Particle comm iterations/step: 3
Particle fraction communicated: 0.348703
Particle fraction colliding with boundary: 0.385347
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.969327
Collisions/particle/step: 0.703273

Move  time (%) = 0.0102043 (63.2612)
Coll  time (%) = 0.00519177 (32.1862)
Sort  time (%) = 0.000229776 (1.42449)
Comm  time (%) = 0.000323504 (2.00555)
Outpt time (%) = 0.000166655 (1.03317)
Other time (%) = 1.44243e-05 (0.089423)

Particles: 1250 ave 1290 max 1170 min
Histogram: 1 0 0 0 1 0 1 3 0 2
Cells:      125 ave 125 max 125 min
Histogram: 8 0 0 0 0 0 0 0 0 0
GhostCell: 149.625 ave 218 max 91 min
Histogram: 1 0 3 0 0 0 3 0 0 1
EmptyCell: 58.625 ave 127 max 0 min
Histogram: 1 0 3 0 0 0 3 0 0 1
timestep 	    7.00E-9
run 		    100
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 1.02997 1.02997 1.02997
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 2.8611 2.8611 2.8611
Step CPU Np Natt Ncoll temp 
      30            0    10000    10065     7068    269.39603 
      40 0.00085902214    10000      908      716    269.39603 
      50 0.0017490387    10000      915      703    269.39603 
      60 0.0026769638    10000      933      714    269.39603 
      70 0.0035171509    10000      952      726    269.39603 
      80 0.0043821335    10000      948      709    269.39603 
      90 0.0052220821    10000      969      723    269.39603 
     100 0.0060429573    10000      944      675    269.39603 
     110 0.0068609715    10000      954      680    269.39603 
     120 0.0077021122    10000      988      710    269.39603 
     130 0.0085549355    10000      957      683    269.39603 
Loop time of 0.00857282 on 8 procs for 100 steps with 10000 particles

Particle moves    = 1000000 (1M)
Cells touched     = 1356902 (1.36M)
Particle comms    = 39105 (39.1K)
Boundary collides = 39627 (39.6K)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 93600 (93.6K)
Collide occurs    = 69973 (70K)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 1.4581e+07
Particle-moves/step: 10000
Cell-touches/particle/step: 1.3569
Particle comm iterations/step: 1
Particle fraction communicated: 0.039105
Particle fraction colliding with boundary: 0.039627
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.0936
Collisions/particle/step: 0.069973

Move  time (%) = 0.0039672 (46.2765)
Coll  time (%) = 0.00217667 (25.3904)
Sort  time (%) = 0.000542611 (6.32944)
Comm  time (%) = 0.00157315 (18.3504)
Outpt time (%) = 0.00028494 (3.32376)
Other time (%) = 2.82526e-05 (0.32956)

Particles: 1250 ave 1290 max 1210 min
Histogram: 1 1 0 1 1 2 0 0 0 2
Cells:      125 ave 125 max 125 min
Histogram: 8 0 0 0 0 0 0 0 0 0
GhostCell: 149.625 ave 218 max 91 min
Histogram: 1 0 3 0 0 0 3 0 0 1
EmptyCell: 58.625 ave 127 max 0 min
Histogram: 1 0 3 0 0 0 3 0 0 1

