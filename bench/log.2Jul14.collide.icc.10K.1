SPARTA (5 Dec 2013)
# advect particles on uniform 3d Cartesian grid
# particles reflect off global box boundaries

variable            x index 10
variable            y index 10
variable            z index 10

variable            lx equal $x*1.0e-5
variable            lx equal 10*1.0e-5
variable            ly equal $y*1.0e-5
variable            ly equal 10*1.0e-5
variable            lz equal $z*1.0e-5
variable            lz equal 10*1.0e-5

variable            n equal 10*$x*$y*$z
variable            n equal 10*10*$y*$z
variable            n equal 10*10*10*$z
variable            n equal 10*10*10*10

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5

boundary	    rr rr rr

create_box  	    0 ${lx} 0 ${ly} 0 ${lz}
create_box  	    0 0.0001 0 ${ly} 0 ${lz}
create_box  	    0 0.0001 0 0.0001 0 ${lz}
create_box  	    0 0.0001 0 0.0001 0 0.0001
Created orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
create_grid 	    $x $y $z
create_grid 	    10 $y $z
create_grid 	    10 10 $z
create_grid 	    10 10 10
Created 1000 child grid cells
  parent cells = 1
  CPU time = 0.000801086 secs
  create/ghost percent = 96.369 3.63095

balance_grid        rcb part
Balance grid migrated 0 cells
  CPU time = 0.00120497 secs
  reassign/sort/migrate/ghost percent = 11.0408 0.15829 1.7412 87.0598

species		    ../data/ar.species Ar
mixture		    air Ar vstream 0.0 0.0 0.0 temp 273.15

global              nrho 7.07043E22
global              fnum 7.07043E6

collide		    vss air ../data/ar.vss

create_particles    air n $n
create_particles    air n 10000
Created 10000 particles
  CPU time = 0.00190687 secs

stats		    10
compute             temp temp
stats_style	    step cpu np nattempt ncoll c_temp

# first equilibrate with large timestep to unsort particles
# then benchmark with normal timestep

timestep 	    7.00E-8
run                 30
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 1.02997 1.02997 1.02997
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 2.8611 2.8611 2.8611
Step CPU Np Natt Ncoll temp 
       0            0    10000        0        0    274.40561 
      10  0.031358957    10000     9664     7046    274.40561 
      20   0.06281805    10000     9910     7069    274.40561 
      30  0.094428062    10000     9997     7009    274.40561 
Loop time of 0.094435 on 1 procs for 30 steps with 10000 particles

Particle moves    = 300000 (0.3M)
Cells touched     = 1382059 (1.38M)
Particle comms    = 0 (0K)
Boundary collides = 120060 (0.12M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 290463 (0.29M)
Collide occurs    = 210897 (0.211M)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 3.17679e+06
Particle-moves/step: 10000
Cell-touches/particle/step: 4.60686
Particle comm iterations/step: 1
Particle fraction communicated: 0
Particle fraction colliding with boundary: 0.4002
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.96821
Collisions/particle/step: 0.70299

Move  time (%) = 0.0506823 (53.669)
Coll  time (%) = 0.0422018 (44.6887)
Sort  time (%) = 0.00137043 (1.45119)
Comm  time (%) = 2.14577e-05 (0.0227222)
Outpt time (%) = 0.000150919 (0.159813)
Other time (%) = 8.10623e-06 (0.00858393)

Particles: 10000 ave 10000 max 10000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Cells:      1000 ave 1000 max 1000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
GhostCell: 0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
EmptyCell: 0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
timestep 	    7.00E-9
run 		    100
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 1.02997 1.02997 1.02997
  grid      (ave,min,max) = 1.83113 1.83113 1.83113
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 2.8611 2.8611 2.8611
Step CPU Np Natt Ncoll temp 
      30            0    10000     9997     7009    274.40561 
      40 0.0047979355    10000      895      696    274.40561 
      50 0.0096819401    10000      925      687    274.40561 
      60  0.014579058    10000      942      713    274.40561 
      70   0.01949501    10000      950      718    274.40561 
      80  0.024407148    10000      929      685    274.40561 
      90  0.029335976    10000      965      705    274.40561 
     100  0.034250021    10000      940      695    274.40561 
     110   0.03918314    10000      974      710    274.40561 
     120  0.044129133    10000      955      685    274.40561 
     130  0.049066067    10000      962      686    274.40561 
Loop time of 0.049073 on 1 procs for 100 steps with 10000 particles

Particle moves    = 1000000 (1M)
Cells touched     = 1360928 (1.36M)
Particle comms    = 0 (0K)
Boundary collides = 40018 (40K)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Collide attempts  = 93740 (93.7K)
Collide occurs    = 70127 (70.1K)
Particles stuck   = 0

Particle-moves/CPUsec/proc: 2.03778e+07
Particle-moves/step: 10000
Cell-touches/particle/step: 1.36093
Particle comm iterations/step: 1
Particle fraction communicated: 0
Particle fraction colliding with boundary: 0.040018
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Collision-attempts/particle/step: 0.09374
Collisions/particle/step: 0.070127

Move  time (%) = 0.0255821 (52.1307)
Coll  time (%) = 0.0184109 (37.5174)
Sort  time (%) = 0.00455308 (9.27818)
Comm  time (%) = 3.69549e-05 (0.075306)
Outpt time (%) = 0.000468969 (0.955657)
Other time (%) = 2.09808e-05 (0.0427544)

Particles: 10000 ave 10000 max 10000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Cells:      1000 ave 1000 max 1000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
GhostCell: 0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
EmptyCell: 0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

